# GENERATED BY KOMAND SDK - DO NOT EDIT
import komand
import json


class Component:
    DESCRIPTION = "Terminates the processes specified on Security Agent endpoints"


class Input:
    AGENT_GUID = "agent_guid"
    FILTER = "filter"
    SERVER_GUID = "server_guid"
    SUSPICIOUS_OBJECT_NAME = "suspicious_object_name"
    TASK_TYPE = "task_type"
    TERMINATION_INFO_LIST = "termination_info_list"
    

class Output:
    DATA = "Data"
    

class TerminateProcessInput(komand.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "agent_guid": {
      "type": "object",
      "title": "Agent GUID",
      "description": "The key is the serverGuid, and the value is a list of agentGuid strings of the endpoints managed by the target server",
      "order": 1
    },
    "filter": {
      "type": "array",
      "title": "Filter",
      "description": "The filter paramter is useful for terminating the amount of agents without specifying the agentGuid",
      "items": {
        "$ref": "#/definitions/filter"
      },
      "order": 2
    },
    "server_guid": {
      "type": "array",
      "title": "Server GUID",
      "description": "GUID of servers which manage the endpoints specified in agentGuid",
      "items": {
        "type": "string"
      },
      "order": 3
    },
    "suspicious_object_name": {
      "type": "string",
      "title": "Suspicious Object Name",
      "description": "File name of the object to terminate",
      "order": 4
    },
    "task_type": {
      "type": "string",
      "title": "Task Type",
      "description": "Type of API request. For Endpoint Sensor, the value is always 4",
      "default": "CMEF",
      "enum": [
        "UNKNOWN",
        "INTERNAL",
        "CM",
        "CMEF",
        "OSF_COMMAND",
        "OSF_QUERY",
        "OSF_NOTIFY",
        "OSF_LOG",
        "MDR_ATTACK_DISCOVERY",
        "OSF_SYS_CALL"
      ],
      "order": 6
    },
    "termination_info_list": {
      "type": "array",
      "title": "Termination Info List",
      "description": "Container for terminationInfoList objects",
      "items": {
        "$ref": "#/definitions/termination_info"
      },
      "order": 5
    }
  },
  "required": [
    "termination_info_list"
  ],
  "definitions": {
    "filter": {
      "type": "object",
      "title": "filter",
      "properties": {
        "type": {
          "type": "integer",
          "title": "Type",
          "description": "Type",
          "order": 1
        },
        "value": {
          "type": "string",
          "title": "Value",
          "description": "Value of the filter type",
          "order": 2
        }
      }
    },
    "termination_info": {
      "type": "object",
      "title": "termination_info",
      "properties": {
        "name": {
          "type": "integer",
          "title": "Name",
          "description": "Metadata type of object to terminate",
          "enum": [
            101
          ],
          "order": 1
        },
        "value": {
          "type": "string",
          "title": "Value",
          "description": "Hash value of the object to terminate",
          "order": 2
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class TerminateProcessOutput(komand.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "Data": {
      "$ref": "#/definitions/termination_api_data",
      "title": "Data",
      "description": "Contains the data returned by the specific API",
      "order": 1
    }
  },
  "required": [
    "Data"
  ],
  "definitions": {
    "termination_api_data": {
      "type": "object",
      "title": "termination_api_data",
      "properties": {
        "Code": {
          "type": "integer",
          "title": "Code",
          "description": "CMEF result codes",
          "order": 1
        },
        "CodeType": {
          "type": "integer",
          "title": "Code Type",
          "description": "Indicate Code is iES/CMEF error code, Apex Central error code or HTTP Code",
          "enum": [
            1,
            2,
            3
          ],
          "order": 2
        },
        "Data": {
          "$ref": "#/definitions/termination_data",
          "title": "Data",
          "description": "Contains the data returned from endpoint server",
          "order": 3
        },
        "Message": {
          "type": "string",
          "title": "Message",
          "description": "CMEF message",
          "order": 4
        },
        "TimeZone": {
          "type": "integer",
          "title": "Time Zone",
          "description": "Time zone",
          "order": 5
        }
      },
      "definitions": {
        "termination_content": {
          "type": "object",
          "title": "termination_content",
          "properties": {
            "agentGuid": {
              "type": "array",
              "title": "Agent GUID",
              "description": "GUID of the terminated agents",
              "items": {
                "type": "string"
              },
              "order": 1
            },
            "message": {
              "type": "string",
              "title": "Message",
              "description": "The error message of the response from Endpoint Sensor server",
              "order": 4
            },
            "processTerminationSummaryGuid": {
              "type": "string",
              "title": "Process Termination Summary GUID",
              "description": "The GUID of the process termination summary",
              "order": 2
            },
            "status": {
              "type": "integer",
              "title": "Status",
              "description": "The status of the agent",
              "enum": [
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                9999
              ],
              "order": 3
            },
            "statusCode": {
              "type": "integer",
              "title": "Status Code",
              "description": "The status code of the response from Endpoint Sensor server",
              "order": 5
            }
          }
        },
        "termination_contents": {
          "type": "object",
          "title": "termination_contents",
          "properties": {
            "content": {
              "$ref": "#/definitions/termination_content",
              "title": "Content",
              "description": "Contains the content returned from Endpoint Sensor server",
              "order": 1
            },
            "message": {
              "type": "string",
              "title": "Message",
              "description": "The error message of the response from Endpoint Sensor server",
              "order": 2
            },
            "statusCode": {
              "type": "integer",
              "title": "Status Code",
              "description": "The status code of the response from Endpoint Sensor server",
              "order": 3
            }
          },
          "definitions": {
            "termination_content": {
              "type": "object",
              "title": "termination_content",
              "properties": {
                "agentGuid": {
                  "type": "array",
                  "title": "Agent GUID",
                  "description": "GUID of the terminated agents",
                  "items": {
                    "type": "string"
                  },
                  "order": 1
                },
                "message": {
                  "type": "string",
                  "title": "Message",
                  "description": "The error message of the response from Endpoint Sensor server",
                  "order": 4
                },
                "processTerminationSummaryGuid": {
                  "type": "string",
                  "title": "Process Termination Summary GUID",
                  "description": "The GUID of the process termination summary",
                  "order": 2
                },
                "status": {
                  "type": "integer",
                  "title": "Status",
                  "description": "The status of the agent",
                  "enum": [
                    0,
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    9999
                  ],
                  "order": 3
                },
                "statusCode": {
                  "type": "integer",
                  "title": "Status Code",
                  "description": "The status code of the response from Endpoint Sensor server",
                  "order": 5
                }
              }
            }
          }
        },
        "termination_data": {
          "type": "object",
          "title": "termination_data",
          "properties": {
            "content": {
              "type": "array",
              "title": "Content",
              "description": "Contents",
              "items": {
                "$ref": "#/definitions/termination_contents"
              },
              "order": 1
            },
            "hasMore": {
              "type": "boolean",
              "title": "Has More",
              "description": "Indicates whether the source has more results",
              "order": 2
            },
            "lastContentId": {
              "type": "string",
              "title": "Last Content ID",
              "description": "ID used to retrieve the next set of results",
              "order": 3
            },
            "serverGuid": {
              "type": "string",
              "title": "Server GUID",
              "description": "Trend Micro UID of the server",
              "order": 4
            },
            "serverName": {
              "type": "string",
              "title": "Server Name",
              "description": "Name of the server",
              "order": 5
            },
            "taskId": {
              "type": "string",
              "title": "Task ID",
              "description": "Task ID received from the request",
              "order": 6
            }
          },
          "definitions": {
            "termination_content": {
              "type": "object",
              "title": "termination_content",
              "properties": {
                "agentGuid": {
                  "type": "array",
                  "title": "Agent GUID",
                  "description": "GUID of the terminated agents",
                  "items": {
                    "type": "string"
                  },
                  "order": 1
                },
                "message": {
                  "type": "string",
                  "title": "Message",
                  "description": "The error message of the response from Endpoint Sensor server",
                  "order": 4
                },
                "processTerminationSummaryGuid": {
                  "type": "string",
                  "title": "Process Termination Summary GUID",
                  "description": "The GUID of the process termination summary",
                  "order": 2
                },
                "status": {
                  "type": "integer",
                  "title": "Status",
                  "description": "The status of the agent",
                  "enum": [
                    0,
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    9999
                  ],
                  "order": 3
                },
                "statusCode": {
                  "type": "integer",
                  "title": "Status Code",
                  "description": "The status code of the response from Endpoint Sensor server",
                  "order": 5
                }
              }
            },
            "termination_contents": {
              "type": "object",
              "title": "termination_contents",
              "properties": {
                "content": {
                  "$ref": "#/definitions/termination_content",
                  "title": "Content",
                  "description": "Contains the content returned from Endpoint Sensor server",
                  "order": 1
                },
                "message": {
                  "type": "string",
                  "title": "Message",
                  "description": "The error message of the response from Endpoint Sensor server",
                  "order": 2
                },
                "statusCode": {
                  "type": "integer",
                  "title": "Status Code",
                  "description": "The status code of the response from Endpoint Sensor server",
                  "order": 3
                }
              },
              "definitions": {
                "termination_content": {
                  "type": "object",
                  "title": "termination_content",
                  "properties": {
                    "agentGuid": {
                      "type": "array",
                      "title": "Agent GUID",
                      "description": "GUID of the terminated agents",
                      "items": {
                        "type": "string"
                      },
                      "order": 1
                    },
                    "message": {
                      "type": "string",
                      "title": "Message",
                      "description": "The error message of the response from Endpoint Sensor server",
                      "order": 4
                    },
                    "processTerminationSummaryGuid": {
                      "type": "string",
                      "title": "Process Termination Summary GUID",
                      "description": "The GUID of the process termination summary",
                      "order": 2
                    },
                    "status": {
                      "type": "integer",
                      "title": "Status",
                      "description": "The status of the agent",
                      "enum": [
                        0,
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7,
                        8,
                        9,
                        10,
                        11,
                        12,
                        13,
                        14,
                        9999
                      ],
                      "order": 3
                    },
                    "statusCode": {
                      "type": "integer",
                      "title": "Status Code",
                      "description": "The status code of the response from Endpoint Sensor server",
                      "order": 5
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "termination_content": {
      "type": "object",
      "title": "termination_content",
      "properties": {
        "agentGuid": {
          "type": "array",
          "title": "Agent GUID",
          "description": "GUID of the terminated agents",
          "items": {
            "type": "string"
          },
          "order": 1
        },
        "message": {
          "type": "string",
          "title": "Message",
          "description": "The error message of the response from Endpoint Sensor server",
          "order": 4
        },
        "processTerminationSummaryGuid": {
          "type": "string",
          "title": "Process Termination Summary GUID",
          "description": "The GUID of the process termination summary",
          "order": 2
        },
        "status": {
          "type": "integer",
          "title": "Status",
          "description": "The status of the agent",
          "enum": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            9999
          ],
          "order": 3
        },
        "statusCode": {
          "type": "integer",
          "title": "Status Code",
          "description": "The status code of the response from Endpoint Sensor server",
          "order": 5
        }
      }
    },
    "termination_contents": {
      "type": "object",
      "title": "termination_contents",
      "properties": {
        "content": {
          "$ref": "#/definitions/termination_content",
          "title": "Content",
          "description": "Contains the content returned from Endpoint Sensor server",
          "order": 1
        },
        "message": {
          "type": "string",
          "title": "Message",
          "description": "The error message of the response from Endpoint Sensor server",
          "order": 2
        },
        "statusCode": {
          "type": "integer",
          "title": "Status Code",
          "description": "The status code of the response from Endpoint Sensor server",
          "order": 3
        }
      },
      "definitions": {
        "termination_content": {
          "type": "object",
          "title": "termination_content",
          "properties": {
            "agentGuid": {
              "type": "array",
              "title": "Agent GUID",
              "description": "GUID of the terminated agents",
              "items": {
                "type": "string"
              },
              "order": 1
            },
            "message": {
              "type": "string",
              "title": "Message",
              "description": "The error message of the response from Endpoint Sensor server",
              "order": 4
            },
            "processTerminationSummaryGuid": {
              "type": "string",
              "title": "Process Termination Summary GUID",
              "description": "The GUID of the process termination summary",
              "order": 2
            },
            "status": {
              "type": "integer",
              "title": "Status",
              "description": "The status of the agent",
              "enum": [
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                9999
              ],
              "order": 3
            },
            "statusCode": {
              "type": "integer",
              "title": "Status Code",
              "description": "The status code of the response from Endpoint Sensor server",
              "order": 5
            }
          }
        }
      }
    },
    "termination_data": {
      "type": "object",
      "title": "termination_data",
      "properties": {
        "content": {
          "type": "array",
          "title": "Content",
          "description": "Contents",
          "items": {
            "$ref": "#/definitions/termination_contents"
          },
          "order": 1
        },
        "hasMore": {
          "type": "boolean",
          "title": "Has More",
          "description": "Indicates whether the source has more results",
          "order": 2
        },
        "lastContentId": {
          "type": "string",
          "title": "Last Content ID",
          "description": "ID used to retrieve the next set of results",
          "order": 3
        },
        "serverGuid": {
          "type": "string",
          "title": "Server GUID",
          "description": "Trend Micro UID of the server",
          "order": 4
        },
        "serverName": {
          "type": "string",
          "title": "Server Name",
          "description": "Name of the server",
          "order": 5
        },
        "taskId": {
          "type": "string",
          "title": "Task ID",
          "description": "Task ID received from the request",
          "order": 6
        }
      },
      "definitions": {
        "termination_content": {
          "type": "object",
          "title": "termination_content",
          "properties": {
            "agentGuid": {
              "type": "array",
              "title": "Agent GUID",
              "description": "GUID of the terminated agents",
              "items": {
                "type": "string"
              },
              "order": 1
            },
            "message": {
              "type": "string",
              "title": "Message",
              "description": "The error message of the response from Endpoint Sensor server",
              "order": 4
            },
            "processTerminationSummaryGuid": {
              "type": "string",
              "title": "Process Termination Summary GUID",
              "description": "The GUID of the process termination summary",
              "order": 2
            },
            "status": {
              "type": "integer",
              "title": "Status",
              "description": "The status of the agent",
              "enum": [
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                9999
              ],
              "order": 3
            },
            "statusCode": {
              "type": "integer",
              "title": "Status Code",
              "description": "The status code of the response from Endpoint Sensor server",
              "order": 5
            }
          }
        },
        "termination_contents": {
          "type": "object",
          "title": "termination_contents",
          "properties": {
            "content": {
              "$ref": "#/definitions/termination_content",
              "title": "Content",
              "description": "Contains the content returned from Endpoint Sensor server",
              "order": 1
            },
            "message": {
              "type": "string",
              "title": "Message",
              "description": "The error message of the response from Endpoint Sensor server",
              "order": 2
            },
            "statusCode": {
              "type": "integer",
              "title": "Status Code",
              "description": "The status code of the response from Endpoint Sensor server",
              "order": 3
            }
          },
          "definitions": {
            "termination_content": {
              "type": "object",
              "title": "termination_content",
              "properties": {
                "agentGuid": {
                  "type": "array",
                  "title": "Agent GUID",
                  "description": "GUID of the terminated agents",
                  "items": {
                    "type": "string"
                  },
                  "order": 1
                },
                "message": {
                  "type": "string",
                  "title": "Message",
                  "description": "The error message of the response from Endpoint Sensor server",
                  "order": 4
                },
                "processTerminationSummaryGuid": {
                  "type": "string",
                  "title": "Process Termination Summary GUID",
                  "description": "The GUID of the process termination summary",
                  "order": 2
                },
                "status": {
                  "type": "integer",
                  "title": "Status",
                  "description": "The status of the agent",
                  "enum": [
                    0,
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    9999
                  ],
                  "order": 3
                },
                "statusCode": {
                  "type": "integer",
                  "title": "Status Code",
                  "description": "The status code of the response from Endpoint Sensor server",
                  "order": 5
                }
              }
            }
          }
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
